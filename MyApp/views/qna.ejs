<!DOCTYPE html>
<html>
  <head>
    <% include ../views/partials/head.ejs%>
  
   
   		<% var entries = JSON.parse(entries) %>
		<% entries.forEach((entry) => { %> 
		<script>
   			var current = entry._id;
		$(".anspost").each(function() {
  		 $(this).data("que", current);
		});
   		</script>
   		<%})%>
   		<script>
   		var value = $(".anspost").data("que");
   		$('.answerForm').submit(function(){ //listen for submit event
    		$.each(params, function(i,param){
        	$('<input />').attr('type', 'hidden')
            .attr('qnum', param.name)
            .attr(value, param.value)
            .appendTo('.answerForm');
    	});

    		return true;
		}); 
   		</script>
   		
  <script>
  $( function() {
    $( "#accordion" ).accordion({
    	heightStyle: "content"
    });
  } );
  </script>
   <style>  
         #accordion{font-size: 16px;}
         #accordion.ui-accordion .ui-accordion-header.ui-state-active { background: #d83848; }
      </style>  
  </head>
  
  <body>
	<div class="row">
		<div class="col-sm-1">
   
		</div>
		<div class="col-sm-10">
			<div class="panel panel-danger">
				<div class="panel-heading">
					<h3>Discussion Board
					<button type="button" class="btn btn-danger btn-md pull-right" data-toggle="modal" data-target="#questionModal"><span class="glyphicon glyphicon-question-sign">Ask</span></button>
					</h3>
					<div class="modal fade" id="questionModal" role="dialog">
    					<div class="modal-dialog modal-sm">
      						<div class="modal-content">
        						<div class="modal-header">
          							<button type="button" class="close" data-dismiss="modal">&times;</button>
          							<h5 class="modal-title">Ask a Question</h5>
        						</div>
        						<div class="modal-body">
        							<form method="post" action="/qna">
          							<div class="form-group">
  										<label for="topic">Topic:</label>
  										<input type="text" class="form-control" id="topic" name="topic">
  										<label for="que">Question:</label>
  										<textarea class="form-control" rows="5" id="que" name="que"></textarea>
									</div>
  									
        						</div>
        						<div class="modal-footer">
          							<input type="submit" class="btn btn-success"  name="ask" value="Ask">
        						</div>
									</form>	
      						</div>
    					</div>
  					</div>
	   	
				</div>
				
				<div class="panel-body">  
					<div id="accordion">
						<% var entries = JSON.parse(entries) %>
						<% entries.forEach((entry) => { %> 
  
						<h3   class="text-justify"><span class="label label-default"> <%=entry.topic%> </span>
							&nbsp; &nbsp;<%=entry.question%>
													
	  				
						</h3>
						<div>
							<div class="well well-lg">
								<div class="row text-justify">
									<div class="media">
										<div class="media-left media-top">
											<img src="/img_avatar1.png" class="media-object" style="width:45px">
										</div>
										<div class="media-body">
											<h6 class="media-heading"><%=entry.username%> <small><i> Posted on <%=entry.quetimestamp%></i></small>
											<button type="button"  class="btn btn-default btn-sm pull-right" data-toggle="modal" data-target="#answerModal">
											<span class="glyphicon glyphicon-pencil">Answer</span></button></h6>
											<%=entry.question%> 
											
											<!--Answer Modal-->
											<div class="modal fade" id="answerModal" role="dialog">
												<div class="modal-dialog modal-sm">
													<div class="modal-content">
														<div class="modal-header">
														<button type="button" class="close" data-dismiss="modal">&times;</button>
														<h5 class="modal-title">Write an Answer</h5>
														</div>
														<div class="modal-body">
														<form class="answerForm" method="post" action="/qna">
															<div class="form-group">
															<label for="ans">Your Answer:</label>
															<textarea class="form-control" rows="5" id="ans" name="ansBody"></textarea>
															</div>
  										
														</div>
														<div class="modal-footer">
															<input type="submit" data-que="0" class="anspost btn btn-success" name="answer" value="Post">
														</div>
														</form>
													</div>
												</div>
											</div>
  										<!--Answer modal Ends-->
											
										</div>
									</div>
      			    
								</div>
								<!--<%=entry.question%>
								<p class="text-right"><small> <%=entry.username%> <i> Posted on <%=entry.quetimestamp%></i></small>
								<button type="button" class="btn btn-default btn-xs" data-toggle="modal" data-target="#answerModal">
								<span class="glyphicon glyphicon-pencil">Answer</span></button></p>-->
							</div>
						
						
						
							<%var ans = JSON.stringify(entry.answers)%>
							<%var ans1 = JSON.parse(ans)%>
							<% ans1.forEach((ans2) => { %> 
							<div class="row text-justify">
								<div class="media">
									<div class="media-left media-top">
										<img src="/img_avatar1.png" class="media-object" style="width:45px">
									</div>
									<div class="media-body">
										<h6 class="media-heading"><%=ans2.username%> <small><i> Posted on February 19, 2016</i></small></h6>
    									<%= ans2.body%> 
									</div>
								</div>
      			    
							</div>
							
							<div class="row text-right">
								<button type="button" class="btn btn-info btn-xs">Rate</button>
							<!--	<button type="button" class="btn btn-primary btn-xs" data-toggle="modal" data-target="#commentModal" value="Comment">
								<span class="glyphicon glyphicon-comment"></span></button>-->
							</div>
							<!--Comment modal-->
       					<!--	<div class="text-left">
								<div class="modal fade" id="commentModal" role="dialog">
									<div class="modal-dialog modal-sm">
										<div class="modal-content">
											<div class="modal-header">
												<button type="button" class="close" data-dismiss="modal">&times;</button>
												<h5 class="modal-title">Write a Comment</h5>
											</div>
											<div class="modal-body">
												<div class="form-group">
												<label for="reply">Comment:</label>
												<textarea class="form-control" rows="5" id="comment"></textarea>
												</div>
											</div>
											<div class="modal-footer">
											<input type="submit" class="btn btn-success" data-dismiss="modal" name="comment" value="Comment">
											</div>
										</div>
									</div>
								</div>
	   						</div> -->
							<!--Comment modal ends-->
							
							<!--</div>-->
       				
       				<% }) %>
       				
       				<!--<div class="text-center">
	  				<button type="button" class="btn btn-default btn-sm" data-toggle="modal" data-target="#answerModal">
	  				<span class="glyphicon glyphicon-pencil">Answer</span></button>
	  				
	  				<div class="text-left">
	  				 <div class="modal fade" id="answerModal" role="dialog">
    					<div class="modal-dialog modal-sm">
      						<div class="modal-content">
        						<div class="modal-header">
          							<button type="button" class="close" data-dismiss="modal">&times;</button>
          							<h5 class="modal-title">Write an Answer</h5>
        						</div>
        						<div class="modal-body">
        						<form method="post" action="/qna">
          							<div class="form-group">
  										<label for="ans">Your Answer:</label>
  										<textarea class="form-control" rows="5" id="ans" name="ansBody"></textarea>
									</div>
  										
        						</div>
        						<div class="modal-footer">
          							<input type="submit" class="btn btn-success" name="answer" value="Post">
        						</div>
        						</form>
      						</div>
    					</div>
  					</div>
  					</div>
	  				</div>-->
	  		
						</div>
	  			
	   			<% }) %>
	   			
					</div>
		 
				</div>
	
			</div>
		</div>     
		<div class="col-sm-1">
   
		</div>
   
	</div>
   
</body>
</html>